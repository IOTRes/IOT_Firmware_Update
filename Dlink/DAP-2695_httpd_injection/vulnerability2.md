# Command Injection Vulnerability in Firmware Update Process of DLink DAP-2695

## Affected Product
DLink DAP-2695 (firmware version: v2.00RC131)

## Overview

During the firmware update process, there is a command injection vulnerability in function check_upgrad() of program httpd. The upload_file is uploaded by the users, which makes it become user input. It could be propagated to system command execution function and become part of function parameters. During the propagation process, there is no verification on upload_file. If the hackers control upload_file, they could inject and execute malicious code. This issue in the firmware update process of Dlink DAP-2695(firmware version:v2.00RC131) allows attackers to execute arbitrary code or cause denial of service via constructing a malicious command and injecting it into upload_file

The exploit chain of command injection vulnerability is FUN_0041e620(upload_file) -> param1-> _ptr -> param3 -> snprintf(acStack_134, 0xff, “unmount %s”, param3) -> system(acStack_134)


<img width="468" height="205" alt="image" src="https://github.com/user-attachments/assets/9508c798-1aae-46f1-b99a-13c1f9aee209" />
<img width="468" height="287" alt="image" src="https://github.com/user-attachments/assets/368f816a-73f5-4156-94fe-18a538f480dc" />
<img width="456" height="319" alt="image" src="https://github.com/user-attachments/assets/5a17ac0c-3ab8-464c-8480-135f8506d6ca" />


