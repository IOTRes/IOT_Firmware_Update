# Command Injection Vulnerability in Firmware Update Process of DLink DAP-2695

## Affected Product
DLink DAP-2695 (firmware version: v2.00RC131)

## Overview

During the firmware update process, there is a command injection vulnerability in function upload_certificate() of program httpd. In function upload_certificate(), certificate is uploaded by string DAT_00444084, then it is passed to pcVar1 which pass the certificate to __s1. function FUN_00416dd8() takes __s1 as param2 and pass it to system execution function system(acStack_818). There is no verification on __s1(DAT_00444084) during the propagation. Once the hackers control it and inject malicious command in it, the malicious command would be passed to system execution function through parameters. This issue in the firmware update process of Dlink DAP-2695(firmware version:v2.00RC131) allows attackers to execute arbitrary code or cause denial of service via constructing a malicious command and injecting it into pcVar1.


The exploit chain of command injection vulnerability is DAT_00444084 -> pcVar1 -> __s1 -> FUN_00416dd8() -> param2 -> local_res4 -> local_18 -> vsprintf(acStack_818, param_1, local_18) -> system(acStack_818)


<img width="435" height="391" alt="image" src="https://github.com/user-attachments/assets/4b110c0f-260f-4137-956d-730bcec01f90" />\
<img width="452" height="196" alt="image" src="https://github.com/user-attachments/assets/fb104e13-3df5-4730-9f0e-670b74beedec" />\
<img width="468" height="274" alt="image" src="https://github.com/user-attachments/assets/03da343d-c237-4307-b06b-8764c2fe7eb1" />
