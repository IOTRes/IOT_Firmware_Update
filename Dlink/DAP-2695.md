# Command Injection Vulnerability in Firmware Update Process of DLink DAP-2695

## Affected Product
DLink DAP-2695 (firmware version: v2.00RC131)

## Overview
During the firmware update process, in function fwupdater_main()  of program rgbin. A user input optarg could be propagated to system command execution function  and become part of the function parameters. During the propagation process, there is no verification on  user input optarg. If the hackers control the user input optarg, they could inject and execute malicious code. This issue in  the firmware update process of Dlink DAP-2695(firmware version:v2.00RC131) attackers to execute arbitrary code or cause denial of service via constructing a malicious command and injecting it into user input.

The exploit chain of command injection vulnerability is fwupdater_main() → sub_40EF84()（snprintf("/var/%s", src); snprintf("rm -f %s", v11)） → sub_40DC38()（vsprintf -> system）

<img width="365" height="316" alt="image" src="https://github.com/user-attachments/assets/a0d52482-f9eb-4584-8940-0e99e85669bc" />\
<img width="342" height="218" alt="image" src="https://github.com/user-attachments/assets/b809594d-1e55-44d7-b8c8-ca0793bd4457" />\
<img width="468" height="337" alt="image" src="https://github.com/user-attachments/assets/ca1d5715-aa13-45c3-a3f2-973a3c419c88" />\
<img width="342" height="318" alt="image" src="https://github.com/user-attachments/assets/bff51189-10c8-401c-ba72-84cbad9f29bd" />



