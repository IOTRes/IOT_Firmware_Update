
# Buffer Overflow Vulnerability in Firmware Update Process of DLink DIR-619L

## Affected Product
DLink DIR-619L (firmware version: 6.02CN02)

## Overview

During the firmware update process, there is a buffer overflow vulnerability in function form_mydlink_sign() of program boa. The variable v4 takes network data through function websGetVar(). function action_Mydlink_Web_Server() takes v4 as the third parameter. In action_Mydlink_Web_Server(), v4 is passed to v40 through strcpy(). Then, function translateEmail() takes v40 as the first parameter where v40 is passed to v41. After that, v41 is passed to v36 which is a 1024-byte character buffer. However, during the data propagation, there is no constraint on v4/v40/v41 such as strlen. Once the hackers control the network data, they could pass data which is larger than 1024 byte to v4 and cause denial of service of firmware update process.

The propagation chain is &dword_4AC5F0 -> v4 -> v40 -> v41 -> v36

<img width="468" height="360" alt="image" src="https://github.com/user-attachments/assets/0be87e70-b0ac-4c3a-b320-c690e8fe092a" />\
<img width="468" height="154" alt="image" src="https://github.com/user-attachments/assets/ab14c715-24ac-4366-a64b-261314fc6e87" />\
<img width="461" height="319" alt="image" src="https://github.com/user-attachments/assets/8d153e62-bb0d-4796-82d1-1cf0943e196f" />\
<img width="468" height="109" alt="image" src="https://github.com/user-attachments/assets/19081f1d-37c4-4156-8d17-9bc680a8ce98" />



