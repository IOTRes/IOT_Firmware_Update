# Buffer Overflow Vulnerability in Firmware Update Process of DLink DIR-878 A1


## Affected Product
DLink DIR-878 A1 (firmware version: FW104B05)

## Overview
During the firmware update process, there is a buffer overflow vulnerability in function sub_465A30 of program prog.cgi. A 16MB buffer is allocated to store the new firmware image for update. The firmware size is obtained in the firmware header. Then, read the new firmware image to the buffer. However, there is no constraint or verification on the size of new firmware image. Once the size is greater than 16MB, buffer overflow exception occurs which might interrupt the firmware update.

<img width="807" height="438" alt="Snipaste_2025-08-26_16-57-49" src="https://github.com/user-attachments/assets/305706f7-a915-41a4-9cbf-9cd9029f8c58" />
<img width="563" height="540" alt="Snipaste_2025-08-26_17-12-19" src="https://github.com/user-attachments/assets/52764516-16a3-4344-81b5-29068b01105f" />

